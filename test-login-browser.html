<!DOCTYPE html>
<html>
<head>
    <title>Login Debug Test</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <h1>Login Debug Test</h1>
    <div id="results"></div>
    
    <script>
        const API_BASE = 'http://localhost:4000/api';
        
        async function testLogin(email, password, name) {
            console.log(`\n=== Testing ${name} ===`);
            console.log('Email:', email);
            console.log('Password:', password);
            
            try {
                const response = await axios.post(`${API_BASE}/auth/login`, {
                    email: email,
                    password: password
                });
                
                console.log('✅ Raw Response:', response.data);
                console.log('✅ Response Structure:', JSON.stringify(response.data, null, 2));
                
                if (response.data.success) {
                    console.log('✅ Login Success!');
                    console.log('✅ Token:', response.data.data?.token);
                    console.log('✅ User:', response.data.data?.user);
                    
                    // Test localStorage
                    localStorage.setItem('authToken', response.data.data?.token || 'NO_TOKEN');
                    localStorage.setItem('user', JSON.stringify(response.data.data?.user || 'NO_USER'));
                    
                    console.log('✅ localStorage Test - Token:', localStorage.getItem('authToken'));
                    console.log('✅ localStorage Test - User:', localStorage.getItem('user'));
                    
                    return 'SUCCESS';
                } else {
                    console.log('❌ Login Failed:', response.data.message);
                    return 'FAILED';
                }
                
            } catch (error) {
                console.log('❌ API Error:', error.message);
                console.log('❌ Status:', error.response?.status);
                console.log('❌ Response:', error.response?.data);
                return 'ERROR';
            }
        }
        
        async function testAll() {
            const credentials = [
                { email: 'admin@maplorix.com', password: 'admin123', name: 'Primary' },
                { email: 'maplorixae@gmail.com', password: 'maplorixDXB', name: 'Secondary' },
                { email: 'info@maplorix.ae', password: 'admin123', name: 'Tertiary' }
            ];
            
            for (let i = 0; i < credentials.length; i++) {
                const result = await testLogin(credentials[i].email, credentials[i].password, credentials[i].name);
                
                const div = document.getElementById('results');
                div.innerHTML += `<p><strong>${credentials[i].name}:</strong> ${result}</p>`;
                
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
        }
        
        // Start testing
        testAll();
    </script>
</body>
</html>
